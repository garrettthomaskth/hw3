\subsection{Order of accuracy of the method}
We will now try to compute the order of accuracy of McCormack's scheme. To do this, we will plug the solution of the PDE into the scheme and use Taylor's expansion. We will prove that it is second order accurate in both space and time for a linear PDE. Let $u(x,t)$ be the solution of the following PDE : 
$$u_t + (f(u))_x =u_t + au_x = 0$$

Let us first compute the second order time derivative of $u$ : 
$$u_{tt} = -au_{xt} = -au_{tx} = -a (u_t)_x = (-a)(-a)u_{xx} = a^2u_{xx}$$

Let us now compute the left hand side of the scheme :
$$u(x_j,t_{n+1}) = u(x_j,t_n) + \Delta t u_t(x_j,t_n) + \frac{\Delta t^2}{2} u_{tt}(x_j,t_n) + O(\Delta t^3)$$

Using Taylor expansion as well as the PDE, the first half of the right hand side is given by :
\begin{align*}
\frac{1}{2}(u+u^*) &= u - \frac{\Delta t}{2\Delta x}a(u(x_j+\Delta x,t_n)-u(x_j,t_n))\\
&= u - \frac{\Delta t}{2\Delta x}a(\Delta x \: u_x(x_j,t_n) + \frac{\Delta x^2}{2}u_{xx}(x_j,t_n)+O(\Delta x^3))\\
&= u - a\frac{\Delta t}{2}(u_x(x_j,t_n)+\frac{\Delta x}{2} u_{xx}(x_j,t_n)+O(\Delta t\Delta x^2)\\
&= u + \frac{\Delta t}{2} \: u_t(x_j,t_n) - a\frac{\Delta t \Delta x}{4}u_{xx}(x_j,t_n) + O(\Delta t\Delta x^2)
\end{align*}

The second part is slightly more complex so let us compute $f(u_j^*)-f(u_{j-1}^*)$ beforehand.
\begin{align*}
f(u_j^*)-f(u_{j-1}^*) &= a(u_j^*-u_{j-1})^*\\
&=a[(u(x_j,t_n)-a\frac{\Delta t}{\Delta x}(u(x_j+\Delta x,t_n)-u(x_j,t_n)) -...\\
&... (u(x_j-\Delta x,t_n)-a\frac{\Delta t}{\Delta x}(u(x_j,t_n)-u(x_j-\Delta x,t_n))]\\
&= a[(u(x_j,t_n) - u(x_j-\Delta x,t_n)) - a\frac{\Delta t}{\Delta x}((u(x_j+\Delta x,t_n) - 2u(x_j,t_n)+u(x_j-\Delta x,t_n))\\
&=a[(\Delta x\: u_x(x_j,t_n)-\frac{\Delta x^2}{2}u_{xx}(x_j,t_n)+O(\Delta x^3))- a\frac{\Delta t}{\Delta x}(\Delta x^2 \: u_{xx}(x_j,t_n) +O(\Delta x^4))]
\end{align*}

Let us now multiply by $-\frac{\Delta t}{\Delta x}$ to get the second part of the right hand side and use the PDE : 
\begin{align*}
-\frac{\Delta t}{\Delta x}(f(u_j^*)-f(u_{j-1}^*)) &= -a\frac{\Delta t}{2}u_x(x_j,t_n) + \frac{\Delta t\Delta x}{4}u_{xx}(x_j,t_n) + a^2\Delta t^2 \: u_{xx}(x_j,t_n) + O(\Delta t\Delta x^2)\\
&= \frac{\Delta t}{2} u_t(x_j,t_n) + \frac{\Delta t\Delta x}{4}u_{xx}(x_j,t_n) + \Delta t^2 \: u_{tt}(x_j,t_n) + O(\Delta t\Delta x^2)
\end{align*}

Summing the two expressions together, we get the following for the right hand side :
$$u_j^{t+1} = u(x_j,t_n) + \Delta t \: u_t(x_j,t_n) + \Delta t^2 \: u_{tt}(x_j,t_n) + O(\Delta t\Delta x^2)$$

Finally, we can compare the two side to have :

$$\frac{1}{\Delta t}(u(x_j,t_{n+1})-u_j^{n+1}) = O(\Delta x^2) + O(\Delta t^2)$$

And we can conclude by saying the method is indeed order 2 in both space and time.








